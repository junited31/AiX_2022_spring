---
layout: post
title: cGAN 기반 pix2pix 모델을 이용한 흑백 이미지 컬러화
---

## 1. 서론
 &nbsp;

 &nbsp;&nbsp;흑백 이미지들은 주로 오래된 기록물, 콘텐츠 등에서 다뤄진다. 대한민국 역사를 담고 있는 1950~1980년대 이미지 또한 흑백 이미지가 대다수이다. 이러한 흑백 이미지에 컬러를 입히는 Colorization 기술을 통해 자료들을 복원하는 것은 사회적/경제적 가치 측면에서 매우 의미 있는 일이며, 이에 대한 need가 나타나고 있다. 

 ![Colorization](https://user-images.githubusercontent.com/102155443/166240639-b9d43419-1e3a-496e-94af-1f252419dbd4.png)(출처: https://www.sktaifellowship.com/418f1412-55bf-46c9-8c7d-6e6c34e0ca52)

 &nbsp;SKT AI Fellowship 4기의 과제 List 중 하나로 딥러닝 기반 흑백 이미지 컬러화 기술 개발이 선정되면서, 컬러화 기술의 필요성을 실감하게 되어 대표적인 컬러화 모델인 pix2pix로 흑백 이미지 컬러화를 진행해보려 한다.

 &nbsp;

---

 &nbsp;

## 2. 데이터 셋
 &nbsp;

 Victorian400(kaggle)

 &nbsp;이 데이터 셋은 Charles Dickens의 일러스트레이션을 채색하기 위해 만들어졌다. 그러나 데이터 부족으로 인해 이 데이터 셋의 범위는 19세기 삽화로 확장되었고, 19세기의 다양한 이미지가 흑백 이미지로 변환되어 데이터 셋에 포함되었다.

 &nbsp;

---

&nbsp;

## 3. 본론
 &nbsp;

 &nbsp;&nbsp;cGAN(Conditional Generative Adversarial Networks)은 비지도학습인 GAN(Generative Adversarial Networks)의 한 종류이다. 2014년, Ian Goodfellow의 'Generative Adversarial Network'라는 논문에서 제안된 GAN은 진짜 데이터와 비슷한 데이터를 생성하는 Generator(생성기)와 generator가 생성한 데이터를 판별하는 Discriminator(판별기)로 구성되어 있다. Discriminator가 진짜 혹은 가짜 데이터인지 판별할 수 없는 경계를 GAN에서의 최적의 솔루션으로 간주한다. 이를 논문에서는 ‘경찰과 위조지폐범’을 예시로 들어 GAN 모델의 개념을 설명하고 있다. 

 ![GAN](https://user-images.githubusercontent.com/102155443/170975791-6fd07e2b-0771-4666-ac66-63ed4f4913b4.png)(출처: Hamed Alqahtani. 2019. An Analysis Of Evaluation Metric Of GANs)

 &nbsp;일반적인 GAN의 구조에서 판별기는 실제 데이터를 진짜로 분류하도록, 생성기가 생성한 가짜 데이터를 가짜로 분류하도록 학습한다. 그리고 학습된 판별기가 가짜 데이터를 진짜로 분류하도록 생성기를 학습한다. 이는 게임이론 타입의 목적함수로 수식화되며, 생성기와 판별기가 서로 경쟁하며 Nash equilibrium(내시 균형)에 도달하도록 하는 minmax problem이다.

 ![minmax problem](https://user-images.githubusercontent.com/102155443/170982122-a8ba8188-8c5d-46e5-9d0c-ea2c0e03a4cb.png)(출처: Ian J.Goodfellow. 2014. Generative Adversarial Nets)

 &nbsp; x~Pdata(x)는 실제 데이터에 대한 확률분포에서 샘플링한 데이터, Z~Pz(z)는 일반적으로 Zero-Mean Gaussian 분포에서의 임의의 노이즈에서 샘플링한 데이터를 의미한다. D(x)는 데이터가 진짜일 경우 1, 가짜인 경우 0의 값을 가진다. 판별기는 목적함수 V(D, G)가 최대가 되도록 첫번째 항의 D(x), 두번째 항의 1-D(G(z))가 최대가 되어야 한다. 이는 실제 데이터를 진짜 데이터라고 분류하여 판별기 D(x)가 1이 되도록, 생성기가 생성한 가짜 데이터를 가짜로 분류하여 D(G(z))가 0이 되도록 학습하는 것을 의미한다. 반대로 생성자는 V(D, G)가 최소가 되도록 두번째 항의 D(G(z))가 1이 되도록 학습하는 것을 의미한다. 이때 첫번째 항에는 G와 독립적이므로 생략이 가능하다. 이러한 학습은 하나의 네트워크를 고정시킨 상태에서 다른 네트워크를 업데이트하는 방식으로 학습이 진행된다. 

 &nbsp;cGAN은 지도학습으로 훈련 데이터가 라벨링되어 있어야 한다는 점과, 이를 통해 인위적으로 원하는 클래스의 데이터를 샘플링할 수 있다는 점이 GAN과 다르다. 

 &nbsp;GAN 구조, cGAN 구조, minmax problem

 &nbsp;
 

---

## 4. 결론


---

## 5. 참고문헌
